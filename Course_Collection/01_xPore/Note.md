# xPore: An AI-Powered App for Bioinformaticians

**xPore** is a software tool designed to compare RNA base positions across different cell types, such as those from cancer patients and healthy individuals, to uncover molecular differences. It analyzes electrical signal data generated by the Nanopore sequencer, enabling the direct and efficient sequencing of RNA bases.

## Problem Statement

Develop software to analyze RNA modifications and their impact on health and disease. Using Nanopore sequencing, researchers can directly sequence RNA, identifying modifications like m6A by detecting changes in electrical signals caused by molecular differences.

### Key Concepts

- **Central Dogma:** DNA is transcribed into mRNA, which is translated into proteins that regulate bodily functions and diseases.
- **Gene Expression:** RNA sequencing measures mRNA activity to study gene behavior and detect abnormalities.
- **Nanopore RNA Sequencing:** Nanopore technology directly sequences RNA by analyzing electrical signals from RNA bases.
- **RNA Modifications:** Chemical changes like m6A in RNA bases influence cell functions and may contribute to diseases.

### Objective

- Locate modified positions (e.g., m6A).
- Quantify fraction of modified reads (modification rate).

### Tools

- **Supervised:** EpiNano, MINES
- **Unsupervised:** Tombo, Nanocompore, xPore

## Data Collection and Preparation

### Data Collection

- **FAST5:** Binary HDF5 files from the Nanopore sequencer storing raw electrical signals (current intensity levels in pA) for each RNA read.
- **FASTQ:** Text files containing basecalled sequences, converted from electrical signals during base calling.
- **FASTA:** Reference sequence files in text format, representing RNA converted to DNA.
- **BAM/SAM:** Files storing alignment results of FASTQ sequences mapped to FASTA references, showing which reads align to specific genes.

### Preprocessing

1. **Direct RNA Sequencing:** Collect electrical signals as current intensity levels from Nanopore sequencing.
2. **Base Calling:** Convert electrical signal patterns into RNA base sequences (G, T, A, C) using Guppy, generating FASTQ files from FAST5.
3. **Sequence Alignment:** Align FASTQ sequences to FASTA references using Minimap2, producing BAM alignment files.
4. **Signal Event Alignment:** Map raw electrical signals to specific RNA bases using Nanopolish, combining FAST5, FASTA, and BAM files to generate aligned outputs.

## Bayesian Multi-Sample Gaussian Mixture Modelling

### Key Concepts

- **Gaussian Distribution:** A bell-shaped probability distribution where the x-axis represents values (e.g., signal intensity) and the y-axis represents their frequency or probability.
- **Gaussian Mixture Modelling (GMM):** A method that combines multiple Gaussian distributions to represent complex data patterns. Data points are assigned to components based on probabilities.
- **GMM Inference:** Begins with random parameter initialization (e.g., mean and variance) and iteratively updates them until the model aligns with the observed data.
- **Bayesian Multi-Sample Gaussian Mixture Modelling:**
  - Compares RNA signals from multiple samples to identify modified RNA using Gaussian distributions.
  - Bayesian inference estimates parameters for classification and modification rate calculation.

### Why Use This Model?

- **Accurate Representation:** Captures up to two distributions (e.g., unmodified and modified RNA) per site.
- **Multi-Sample Comparisons:** Accommodates differences across numerous samples efficiently.
- **Nanopolish Integration:** Utilizes Gaussian assumptions for signal events in k-mers.
- **Optimized Performance:** Leverages parallel processing for faster computations.

### Speed-Up ML Experiments

- **Automation:** Simplifies tasks like hyperparameter tuning and testing multiple datasets.
- **Flexibility:** Supports diverse models and methodologies, enabling scalable machine learning workflows.

## Evaluation

### Experiment Setup

- **Objective:** Validate xPore’s accuracy in identifying m6A sites.
- **Method:**
  - Samples: WT (natural m6A) and KO (m6A-inactivated) RNA from human kidney cells.
  - Sequencing: Direct RNA Sequencing for both samples.
  - Prediction: Use GMM for m6A site detection, validated against m6ACE-Seq reference sites.
  - Motif Verification: Confirm DRACH motifs (e.g., GGACT, AGACT) at predicted sites.
  - Enrichment: Differentially modified sites enriched at stop codons.

### Validation

- **m6A Calling:**
  - Tested ~1M sites, achieving AUC-ROC of 86%.
  - Accuracy >95% when combining m6ACE-Seq and DRACH motifs.
  - dRNA-Seq identified additional unique sites.
- **m6A Stoichiometry Quantification:**
  - Predicted modification rates closely match expected fractions.
  - Enables differential modification analysis.
- **ML Metrics & Result Analysis:**
  - ROC Curve, Precision-Recall, Accuracy.
  - Domain-specific insights (e.g., motifs, positional enrichment).

### Applicability

- **Full Dataset:** Identify m6A sites transcriptome-wide across tissues.
- **Cross-Dataset Comparison:** Analyze differential m6A modifications across tissues and cell lines.
- **Clinical Data:** Identify m6A modifications in patient samples using dRNA-Seq, with potential for disease-specific discoveries.

### Key Takeaways

- **Validation:** Use ML metrics and biological insights for evaluation.
- **Applicability:** Expand usage to external datasets, human clinical samples, and comparative studies.
- **Discovery:** xPore facilitates novel discoveries and advances RNA modification research.

## Visualization and Presentation

### Storylining

- **Method Overview:** Schematic workflow of RNA modification quantification using xPore.
- **Validation:** Detection of m6A sites with high precision and accurate modification rate estimation.
- **Applicability and Discovery:** Identification of differentially modified regions across tissues, cell lines, and clinical samples.

### Guidelines for Effective Storylining

- UUse visuals as the foundation for communication.
- Highlight method, validation, and applicability clearly.
- Create layouts that enhance clarity and engagement, enabling quick comprehension for readers.

### Key Success

- **Alignment with Needs:** Ensure research addresses real-world problems.
- **Generalization and Evaluation:** Robust validation across datasets and scenarios.
- **Simple Deployment:** Online documentation, easy installation, open-source availability, lightweight, and fast execution.

## Future Work

### Domain-Oriented

- **m6anet:** Use supervised learning to train a model with xPore outputs.
- **Gaussian Mixture Model (GMM):** GMM may not be ideal for long-tailed distributions, and model performance may degrade. Consider experimenting with different distributions.
- **Interpretability:** Address the challenge of distinguishing between modifications (other than m6A) and basecalling errors.
- **End-to-End Models:** Future software changes (e.g., Guppy, Nanopolish) may require a model that doesn’t rely on segment patterns, allowing for a more integrated, end-to-end approach.

### Method-Oriented

- **Deep Autoencoder + GMM:** Integrating GMM with deep learning models (e.g., CNN) can enhance performance and tackle challenges that traditional models haven’t solved yet.
